(window.webpackJsonp=window.webpackJsonp||[]).push([[112],{494:function(a,s,e){"use strict";e.r(s);var t=e(14),r=Object(t.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"振弦应变"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#振弦应变"}},[a._v("#")]),a._v(" 振弦应变")]),a._v(" "),s("p",[a._v("2021-01-12：程序修改")]),a._v(" "),s("p",[a._v("新增功能：添加数值稳定开关")]),a._v(" "),s("h2",{attrs:{id:"变量定义"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#变量定义"}},[a._v("#")]),a._v(" 变量定义")]),a._v(" "),s("h3",{attrs:{id:"地址"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#地址"}},[a._v("#")]),a._v(" 地址")]),a._v(" "),s("h4",{attrs:{id:"serial-protocol-h-68行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#serial-protocol-h-68行"}},[a._v("#")]),a._v(" serial-protocol.h -- 68行")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("#define ADDR_S1_LONG_END     (unsigned long)(ADDR_S1_LONG_START + 40)//44\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("修改：")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("#define ADDR_ENABLE_STABILIZER (unsigned long)(ADDR_S1_LONG_START + 44)\n#define ADDR_S1_LONG_END     (unsigned long)(ADDR_S1_LONG_START + 44)//48\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("p",[a._v("对比：")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("#define ADDR_ENABLE_STABILIZER (unsigned long)(ADDR_S1_LONG_START + 44)\n#define ADDR_S1_LONG_END     (unsigned long)(ADDR_S1_LONG_START + 48)//52\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("h3",{attrs:{id:"变量名"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#变量名"}},[a._v("#")]),a._v(" 变量名")]),a._v(" "),s("h4",{attrs:{id:"data-struct-h-136行-新增"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#data-struct-h-136行-新增"}},[a._v("#")]),a._v(" data_struct.h  -- 136行 新增")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("unsigned long enable_stabilizer_flag;\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h2",{attrs:{id:"主程序"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#主程序"}},[a._v("#")]),a._v(" 主程序")]),a._v(" "),s("h3",{attrs:{id:"命令解析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#命令解析"}},[a._v("#")]),a._v(" 命令解析")]),a._v(" "),s("h4",{attrs:{id:"main-c-916行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#main-c-916行"}},[a._v("#")]),a._v(" main.c  -- 916行")]),a._v(" "),s("div",{staticClass:"language-c line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("case")]),a._v(" ADDR_ENABLE_STABILIZER"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v("\n    g_savedconfig"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("names"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("enable_stabilizer_flag "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    s_enable_stabilizer "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("!")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("data "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("p",[a._v("用于处理命令中的地址为ADDR_ENABLE_STABILIZER的情况。根据命令中的数据值，将其赋值给变量g_savedconfig.names.enable_stabilizer_flag，并根据数据值的不同，更新变量s_enable_stabilizer的值。")]),a._v(" "),s("p",[a._v("(1)数据值为0，即表示关闭稳压器功能，那么将enable_stabilizer_flag设置为0，并将s_enable_stabilizer设置为false；")]),a._v(" "),s("p",[a._v("(2)如果数据值非零，即表示打开稳压器功能，那么将enable_stabilizer_flag设置为非零值，并将s_enable_stabilizer设置为true。")]),a._v(" "),s("h3",{attrs:{id:"初始化变量"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#初始化变量"}},[a._v("#")]),a._v(" 初始化变量")]),a._v(" "),s("h4",{attrs:{id:"main-c-85行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#main-c-85行"}},[a._v("#")]),a._v(" main.c  -- 85行")]),a._v(" "),s("p",[a._v("bool s_enable_stabilizer;")]),a._v(" "),s("h4",{attrs:{id:"main-c-621行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#main-c-621行"}},[a._v("#")]),a._v(" main.c  -- 621行")]),a._v(" "),s("div",{staticClass:"language-c line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[a._v("g_savedconfig"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("names"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("enable_stabilizer_flag "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h3",{attrs:{id:"关闭比较"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#关闭比较"}},[a._v("#")]),a._v(" 关闭比较")]),a._v(" "),s("h4",{attrs:{id:"main-1486行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#main-1486行"}},[a._v("#")]),a._v(" main 1486行")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("if(s_freq[s_current_channel%16]!=0)\n        {\n        if(((s_freq[s_current_channel%16]>freq_eval_s1)&&(s_freq[s_current_channel%16]-freq_eval_s1<20))||\n            ((freq_eval_s1>=s_freq[s_current_channel%16])&&(freq_eval_s1-s_freq[s_current_channel%16]<20))\n        || !s_enable_stabilizer)//无需判断稳定性直接设置采集结果\n            { \n                    t_pwm2=0;\n                    next_state =SAMPLE_STATE_END;\n                    g_sample.freq_eval_c1 =( freq_eval_s1+s_freq[s_current_channel%16])/2;\n                    break;\n            }\n        }\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br")])]),s("p",[a._v("在原有的基础上增加了一个判断条件：如果s_enable_stabilizer为false，即稳压器功能被关闭，则无需进行稳定性判断，直接设置采集结果。")]),a._v(" "),s("h3",{attrs:{id:""}},[s("a",{staticClass:"header-anchor",attrs:{href:"#"}},[a._v("#")])]),a._v(" "),s("h4",{attrs:{id:"main-2237行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#main-2237行"}},[a._v("#")]),a._v(" main 2237行")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("s_enable_stabilizer = !(para_read[3] == 0);\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("对s_enable_stabilizer变量进行赋值。它通过判断para_read数组中的第四个元素是否为0，来决定s_enable_stabilizer的值。如果第四个元素为0，则s_enable_stabilizer被赋值为false；否则，被赋值为true。这个变量可能是用来控制稳压器功能的开启或关闭。")]),a._v(" "),s("p",[a._v("extern u16 para_read[4];")]),a._v(" "),s("p",[a._v("这段代码声明了一个名为para_read的u16类型的数组，数组长度为4。使用extern关键字可以表示该数组是在其他文件中定义的全局变量，当前文件中只是对其进行声明。这样，在当前文件中就可以使用para_read数组来访问和操作它存储的数据。需要注意的是，在当前文件中使用para_read数组之前，需要在其他地方对其进行定义和初始化。")])])}),[],!1,null,null,null);s.default=r.exports}}]);