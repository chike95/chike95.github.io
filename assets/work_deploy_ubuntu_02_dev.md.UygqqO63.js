import{_ as i,c as a,o as n,a4 as p}from"./chunks/framework.4aTu-Nia.js";const l="/assets/image.fu17-Udn.png",t="data:image/png;base64,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",h="/assets/ssh-xshell.D_2s1xcr.png",s="/assets/java_v.C4nxG6Eu.png",e="/assets/jdk1.8.DFKxcC8Q.png",k="/assets/mysql.ByPF9_vM.png",B=JSON.parse('{"title":"二、环境搭建","description":"","frontmatter":{},"headers":[],"relativePath":"work/deploy/ubuntu/02_dev.md","filePath":"work/deploy/ubuntu/02_dev.md"}'),d={name:"work/deploy/ubuntu/02_dev.md"},r=p('<h1 id="二、环境搭建" tabindex="-1">二、环境搭建 <a class="header-anchor" href="#二、环境搭建" aria-label="Permalink to &quot;二、环境搭建&quot;">​</a></h1><h3 id="修改-ip" tabindex="-1">修改 ip <a class="header-anchor" href="#修改-ip" aria-label="Permalink to &quot;修改 ip&quot;">​</a></h3><p>（1）首先查看目前 ip</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ipconfig</span></span></code></pre></div><p><img src="'+l+`" alt="alt text" data-fancybox="gallery"></p><p>（2）打开配置文件</p><div class="warning custom-block"><p class="custom-block-title">注意事项，netplan 为 ubuntu18+默认配置文件</p><p>检查是否安装</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ubuntu@ubuntu:~$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> which</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> netplan</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/usr/sbin/netplan</span></span></code></pre></div><p>没有返回的话，需要自行安装</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> netplan.io</span></span></code></pre></div></div><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/netplan/01-netcfg.yaml</span></span></code></pre></div><p>（3）修改配置</p><p>(eth0:注意需要通过 ifconfig –a 确认)</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># This file describes the network interfaces available on your system</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># For more information, see netplan(5).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">network:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  version:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  renderer:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> networkd</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  ethernets:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    eth0:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      dhcp4:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> no</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      addresses:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [192.168.30.100/24]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      optional:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      gateway4:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 192.168.30.1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      nameservers:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">              addresses:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [192.168.30.1]</span></span></code></pre></div><p>应用</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> netplan</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apply</span></span></code></pre></div><p>重启：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reboot</span></span></code></pre></div><p>查看是否成功</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ubuntu@ubuntu:~$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> addr</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> show</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> eth0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">9:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> eth0:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">BROADCAST,MULTICAST,UP,LOWER_U</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">P</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mtu</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1500</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> qdisc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pfifo_fast</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> state</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> UNKNOWN</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> group</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> default</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> qlen</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    link/ether</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 00:c2:03:ba:dd:6e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> brd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ff:ff:ff:ff:ff:ff</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    inet</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 192.168.30.100/24</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> brd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 192.168.30.255</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scope</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> global</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> eth0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    inet6</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fe80::e975:6b79:93ae:b137/64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scope</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> link</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">       valid_lft</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> forever</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> preferred_lft</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> forever</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    inet6</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fe80::2c2:3ff:feba:dd6e/64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scope</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> link</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">       valid_lft</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> forever</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> preferred_lft</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> forever</span></span></code></pre></div><h2 id="_2-1-远程连接" tabindex="-1">2.1 远程连接 <a class="header-anchor" href="#_2-1-远程连接" aria-label="Permalink to &quot;2.1 远程连接&quot;">​</a></h2><h3 id="_2-1-1-安装-openssh" tabindex="-1">2.1.1 安装 openssh <a class="header-anchor" href="#_2-1-1-安装-openssh" aria-label="Permalink to &quot;2.1.1 安装 openssh&quot;">​</a></h3><h4 id="包管理器安装" tabindex="-1">包管理器安装 <a class="header-anchor" href="#包管理器安装" aria-label="Permalink to &quot;包管理器安装&quot;">​</a></h4><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> openssh</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> openssh-server</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> openssh-client</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ssh-agent.service</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 启动ssh服务</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ssh</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 检查OpenSSH服务器的状态，并确保它正在运行。</span></span></code></pre></div><h4 id="手动安装" tabindex="-1">手动安装 <a class="header-anchor" href="#手动安装" aria-label="Permalink to &quot;手动安装&quot;">​</a></h4><p><a href="https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-9.0p1.tar.gz" target="_blank" rel="noreferrer">https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-9.0p1.tar.gz</a></p><p>tar -xzf openssh-9.0p1.tar.gz</p><h3 id="_2-1-2-免密登录" tabindex="-1">2.1.2 免密登录 <a class="header-anchor" href="#_2-1-2-免密登录" aria-label="Permalink to &quot;2.1.2 免密登录&quot;">​</a></h3><p>（1）切换使用 root 用户</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>su</span></span>
<span class="line"><span>&gt;&gt;输入root密码</span></span></code></pre></div><p>（2）如果没有为 root 创建密码则先设置</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>sudo passwd root</span></span></code></pre></div><p>（3）生成密钥</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>ssh-keygen</span></span></code></pre></div><p>（4）将生成的公钥拷贝到要映射的主机</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>ssh-copy-id -i ~/.ssh/id_rsa.pub root@123.206.175.241</span></span>
<span class="line"><span>ssh-copy-id root@123.206.175.241</span></span></code></pre></div><p>（5）测试免密登陆</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>ssh root@123.206.175.241</span></span></code></pre></div><h3 id="_2-1-3-反向代理" tabindex="-1">2.1.3 反向代理 <a class="header-anchor" href="#_2-1-3-反向代理" aria-label="Permalink to &quot;2.1.3 反向代理&quot;">​</a></h3><h4 id="安装-autossh" tabindex="-1">安装 autossh <a class="header-anchor" href="#安装-autossh" aria-label="Permalink to &quot;安装 autossh&quot;">​</a></h4><p>(1) 下载 autossh 压缩包：</p><p>首先，你需要在官方网站或其他可信赖的资源中下载 autossh 的压缩包。你可以使用 wget 命令来下载，例如：</p><p><a href="https://www.harding.motd.ca/autossh/autossh-1.4e.tgz" target="_blank" rel="noreferrer">https://www.harding.motd.ca/autossh/autossh-1.4e.tgz</a></p><p>(2) 解压缩压缩包：</p><p>使用以下命令解压缩下载的压缩包：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tar</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -xzf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> autossh-1.4e.tgz</span></span></code></pre></div><p>(3) 进入解压后的目录：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> autossh-1.4e</span></span></code></pre></div><p>(4) 编译和安装 autossh：</p><p>在解压后的目录中，执行以下命令编译和安装 autossh：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./configure</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span></span></code></pre></div><p>(5) 验证安装：</p><p>安装完成后，你可以使用以下命令验证 autossh 是否已成功安装：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">autossh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -V</span></span></code></pre></div><p><img src="`+t+`" alt="alt text" data-fancybox="gallery"></p><h4 id="配置教程" tabindex="-1">配置教程 <a class="header-anchor" href="#配置教程" aria-label="Permalink to &quot;配置教程&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SSH反向代理</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">********</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 代理机 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">********</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">这个已在云服务器123.206.175.241好做</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># vi /etc/ssh/shhd_config</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">GatewayPorts</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> yes</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># service sshd restart</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">********</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 目标机 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">********</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">这个需要做</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ssh-keygen     // 生成密钥对</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ssh-copy-id root@123.206.175.241     // 公钥发代理机</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># autossh -M 50202 -fCNR &#39;*:50222:127.0.0.1:22&#39; root@123.206.175.241 // 可手动运行测试</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># pkill -3 autossh // 测试后手动关闭反向代理</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">********</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 目标机配置开机自动启动反向代理 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">********</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">这个需要做</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># vi /etc/rc.local     // 添加启动项到旧配置rc.local</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--------------------------</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">autossh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -M</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 50202</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -fCNR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;*:50222:127.0.0.1:22&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> root@123.206.175.241</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--------------------------&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># vi /etc/systemd/system/rc-local.service     // 旧配置rc.local在启动任务中启动</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--------------------------</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Install]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">WantedBy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">multi-user.target</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Alias</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">rc-local.service</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--------------------------&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ln -s /lib/systemd/system/rc.local.service /etc/systemd/system/   // lnk任务到启动目录</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># systemctl start rc-local.service          // 可手动运行该任务测试，关闭同上</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">********</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SSH加通道 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">********</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">在putty客户机配置，用于测试WEB服务</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PuTTY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 配置</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 连接</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SSH</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 通道</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">源端口</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8080</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">目的地</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 127.0.0.1:8080</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">本地</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">自动</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--------------------------&gt;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">其中</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;源端口&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">指运行putty客户端程序的PC端口</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">其中</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;目的地&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">指远端运行SSH反向代理的目标机IP地址及端口</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">后两项固定</span></span></code></pre></div><h4 id="配置过程" tabindex="-1">配置过程 <a class="header-anchor" href="#配置过程" aria-label="Permalink to &quot;配置过程&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> autossh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -M</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 40001</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -fCNR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;*:40002:127.0.0.1:22&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> root@123.206.175.241</span></span></code></pre></div><p>说明：第一个端口是 autossh 的监视端口 ，将本地（127.0.0.1）的 22 端口映射到远程（123.206.175.241）的 40002 端口</p><p>查看端口情况(123.206.175.241)：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span># 查看所有端口</span></span>
<span class="line"><span>netstat -an</span></span>
<span class="line"><span></span></span>
<span class="line"><span># 查看指定端口</span></span>
<span class="line"><span>netstat -anp | grep 40002</span></span></code></pre></div><p>远程连接现场服务器：123.206.175.241:40002</p><p><img src="`+h+`" alt="Alt text" data-fancybox="gallery"></p><p>如需关闭反向代理</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>pkill -3 autossh</span></span></code></pre></div><p>参考链接：</p><p><a href="https://zhuanlan.zhihu.com/p/112227542" target="_blank" rel="noreferrer">https://zhuanlan.zhihu.com/p/112227542</a></p><p><a href="https://blog.csdn.net/BBQ__ZXB/article/details/112670401" target="_blank" rel="noreferrer">https://blog.csdn.net/BBQ__ZXB/article/details/112670401</a></p><h2 id="_2-2-java-环境" tabindex="-1">2.2 JAVA 环境 <a class="header-anchor" href="#_2-2-java-环境" aria-label="Permalink to &quot;2.2 JAVA 环境&quot;">​</a></h2><p>安装 jdk1.8</p><p>教程：<a href="https://developer.aliyun.com/article/704959" target="_blank" rel="noreferrer">https://developer.aliyun.com/article/704959</a></p><h3 id="_2-2-1-apt-安装" tabindex="-1">2.2.1 apt 安装 <a class="header-anchor" href="#_2-2-1-apt-安装" aria-label="Permalink to &quot;2.2.1 apt 安装&quot;">​</a></h3><p>（1）更新 apt</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span></span></code></pre></div><p>附：更换镜像源 <a href="https://blog.csdn.net/qq_43445867/article/details/123707266" target="_blank" rel="noreferrer">https://blog.csdn.net/qq_43445867/article/details/123707266</a></p><p>(2) 查找合适的 openjdk 版本</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt-cache</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> search</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> openjdk</span></span></code></pre></div><p>（3）安装</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> openjdk-8-jdk</span></span></code></pre></div><p>(4) 配置环境变量</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/.bashrc</span></span></code></pre></div><p>如何编辑？【i:进入编辑模式 esc:退出编辑 :wq 保存】</p><p>在最后一行加上:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> JAVA_HOME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/usr/lib/jvm/java-8-openjdk-amd64</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PATH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$JAVA_HOME/bin:$PATH</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CLASSPATH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar</span></span></code></pre></div><p>(5) 执行 java -version 查看 java 版本</p><p><img src="`+s+'" alt="Alt text" data-fancybox="gallery"></p><h3 id="_2-2-2-压缩包安装" tabindex="-1">2.2.2 压缩包安装 <a class="header-anchor" href="#_2-2-2-压缩包安装" aria-label="Permalink to &quot;2.2.2 压缩包安装&quot;">​</a></h3><p>华为云镜像源：<a href="https://repo.huaweicloud.com/java/jdk/" target="_blank" rel="noreferrer">https://repo.huaweicloud.com/java/jdk/</a></p><p>(1) 下载：jdk-8u171-linux-x64.tar.gz</p><p>(2) 解压：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tar</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -zxvf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> jdk-8u171-linux-x64.tar.gz</span></span></code></pre></div><p>(3) 移动</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> jdk1.8.0_171</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/jdk1.8</span></span></code></pre></div><p>(4) 配置环境变量</p><p>这里我们修改全局配置文件，作用于所有用户：vim /etc/profile 在最后一行添加：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> JAVA_HOME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/usr/local/jdk1.8</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> JRE_HOME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">${JAVA_HOME}/jre</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CLASSPATH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.:${JAVA_HOME}/lib:${JRE_HOME}/lib</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PATH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.:${JAVA_HOME}/bin:$PATH</span></span></code></pre></div><p><img src="'+e+'" alt="Alt text" data-fancybox="gallery"></p><p>(5) 使配置生效</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/profile</span></span></code></pre></div><p>(6) 检查是否安装成功：java -version</p><p><img src="'+s+`" alt="Alt text" data-fancybox="gallery"></p><h2 id="_2-3-数据库" tabindex="-1">2.3 数据库 <a class="header-anchor" href="#_2-3-数据库" aria-label="Permalink to &quot;2.3 数据库&quot;">​</a></h2><h3 id="_2-3-1-安装-mysql" tabindex="-1">2.3.1 安装 mysql <a class="header-anchor" href="#_2-3-1-安装-mysql" aria-label="Permalink to &quot;2.3.1 安装 mysql&quot;">​</a></h3><p>(1) 安装</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 安装mysql服务</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mysql-server</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 安装客户端</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mysql-client</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 安装依赖</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> libmysqlclient-dev</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 检查状态</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> netstat</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -tap</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mysql</span></span></code></pre></div><p>(2) 查看已有账号</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/mysql/debian.cnf</span></span></code></pre></div><p><img src="`+k+`" alt="Alt text" data-fancybox="gallery"></p><p>(3) 登录</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mysql</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -udebian-sys-maint</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -pSPQWakeMtVXByF23</span></span></code></pre></div><p>(4) 查看数据库</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">show</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> databases</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>(5) 使用 ‘mysql’这个库</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">use</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">update</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> user</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> authentication_string=PASSWORD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;自定义密码&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">where</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> user=&#39;root&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">update</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> user</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> plugin=&quot;mysql_native_password&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">flush</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> privileges</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">quit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>(6) 重启</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/etc/init.d/mysql</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span></span></code></pre></div><h3 id="_2-3-2-更改-mysql-数据目录" tabindex="-1">2.3.2 更改 mysql 数据目录 <a class="header-anchor" href="#_2-3-2-更改-mysql-数据目录" aria-label="Permalink to &quot;2.3.2 更改 mysql 数据目录&quot;">​</a></h3><p>系统环境：Ubuntu 12.04（其他版本其实也类似），使用 apt-get install mysql-server。</p><p>默认情况下，mysql 的数据目录是/var/lib/mysql，因为如果你的数据库以后会越来越大，那么你就得考虑用一个空间足够大的分区来存放数据库文件，所以还是选择把它修改到其他位置，比如/usr/data/mysql_data。这个目录可以直接挂载一个大硬盘。</p><p>具体修改方式如下（为了方便起见，你可以先用 su 命令将系统当前用户转到 root，否则以下命令可能都需要加上 sudo 前缀）：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1 停止mysql服务</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/etc/init.d/mysql</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stop</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 2 备份原来的数据目录</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chown</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mysql:mysql</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/data/mysql_data</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 修改存储路径</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/mysql/my.cnf</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 找到datadir=/var/lib/mysql</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 将它改为datadir=/usr/data/mysql_data</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 拷贝原来的数据文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/lib/mysql/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/data/mysql_data</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 启动mysql服务</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/apparmor.d/usr.sbin.mysqld</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#我们会看到此文件中有2行：</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> /var/lib/mysql/</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> r,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> /var/lib/mysql/**</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rwk,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 以上是针对默认数据目录的权限配置，所以据此我们增加两行，指向新目录，设置同样的权限：</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> /newdir/mysql/</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> r,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> /newdir/mysql/**</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rwk,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 实测：（2023-10-28）ubuntu18.04.03 server下，添加以下内容，存储位置：/srv/SqlData/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> /srv/SqlData/</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> r,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> /srv/SqlData/**</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rwk,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/etc/init.d/apparmor</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/etc/init.d/mysql</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span></span></code></pre></div><p>OK，到此就已经成功转移了 mysql 数据目录。</p>`,120),g=[r];function F(c,o,y,u,C,E){return n(),a("div",null,g)}const v=i(d,[["render",F]]);export{B as __pageData,v as default};
